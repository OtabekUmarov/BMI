<div class="main-wrapper">
  <div class="row">
    <div class="col-xl-12">
      <div class="profile-cover"></div>
      <div class="profile-header">
        <div class="profile-img">
          {{#if user.img}}
            <img src="{{user.img}}" alt="" />
          {{else}}
            <img src="/images/avatars/profile-image.png" alt="" />
          {{/if}}
        </div>
        <div class="profile-name">
          <h3>{{user.name}}</h3>
        </div>
        <div class="profile-header-menu">
          <ul class="list-unstyled">
            {{! <li><a href="#" class="active">Feed</a></li>
              <li><a href="#">About</a></li>
              <li><a href="#">Friends</a></li>
              <li><a href="#">Photos</a></li>
              <li><a href="#">Videos</a></li> }}
            <li><button
                class="btn btn-success m-b-xs"
                 data-bs-toggle="modal"
        data-bs-target="#openUserModal"
        onclick="editUser('{{user._id}}')"
              ><i class="fa fa-pen me-2"></i>O'zgartirish</button></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 col-lg-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Shahsiy ma'lumotlar</h5>
          <p>Quisque vel tellus sit amet quam efficitur sagittis. Fusce aliquam
            pulvinar suscipit.</p>
          <ul class="list-unstyled profile-about-list">
            <li><i class="far fa-edit m-r-xxs"></i><span>Studied at
                <a href="#">San Diego University</a></span></li>
            <li><i class="far fa-building m-r-xxs"></i><span>Manager at
                <a href="#">Stacks</a></span></li>
            <li><i class="far fa-compass m-r-xxs"></i><span>From
                <a href="#">New York</a></span></li>
            <li><i class="far fa-user m-r-xxs"></i><span>Followed by 320 people</span></li>
            <li class="profile-about-list-buttons">
              <button class="btn btn-block btn-primary m-t-md">Follow</button>
              <button class="btn btn-block btn-success m-t-md">Message</button>
            </li>
          </ul>
        </div>
      </div>
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Contact Info</h5>
          <ul class="list-unstyled profile-about-list">
            <li><i class="far fa-envelope m-r-xxs"></i><span
              >johan.doe@gmail.com</span></li>
            <li><i class="far fa-compass m-r-xxs"></i><span>Lives in
                <a href="#">San Francisco, CA</a></span></li>
            <li><i class="far fa-address-book m-r-xxs"></i><span>+1 (678) 290
                1680</span></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-md-12 col-lg-6">
      <div class="card">
        <div class="card-body">
          <div class="post">
            <div class="post-header">
              <img src="/images/avatars/profile-image.png" alt="" />
              <div class="post-info">
                <span class="post-author">John Doe</span><br />
                <span class="post-date">3hrs</span>
              </div>
              <div class="post-header-actions">
                <a href="#"><i class="fas fa-ellipsis-h"></i></a>
              </div>
            </div>
            <div class="post-body">
              <p>Proin eu fringilla dui. Pellentesque mattis lobortis mauris eu
                tincidunt. Maecenas hendrerit faucibus dolor, in commodo lectus
                mattis ac.</p>
              <img src="/images/card-image.png" class="post-image" alt="" />
            </div>
            <div class="post-actions">
              <ul class="list-unstyled">
                <li>
                  <a href="#" class="like-btn"><i
                      class="far fa-heart"
                    ></i>Like</a>
                </li>
                <li>
                  <a href="#"><i class="far fa-comment"></i>Comment</a>
                </li>
                <li>
                  <a href="#"><i class="far fa-paper-plane"></i>Share</a>
                </li>
              </ul>
            </div>
            <div class="post-comments">
              <div class="post-comm">
                <img
                  src="/images/avatars/profile-image.png"
                  class="comment-img"
                  alt=""
                />
                <div class="comment-container">
                  <span class="comment-author">
                    Sonny Rosas
                    <small class="comment-date">5min</small>
                  </span>
                </div>
                <span class="comment-text">
                  Mauris ultrices convallis massa, nec facilisis enim interdum
                  ac.
                </span>
              </div>
              <div class="post-comm">
                <img
                  src="/images/avatars/profile-image.png"
                  class="comment-img"
                  alt=""
                />
                <div class="comment-container">
                  <span class="comment-author">
                    Jacob Lee
                    <small class="comment-date">27min</small>
                  </span>
                </div>
                <span class="comment-text">
                  Cras tincidunt quam nisl, vitae aliquet enim pharetra at. Nunc
                  varius bibendum turpis, vitae ultrices tortor facilisis ac.
                </span>
              </div>
              <div class="new-comment">
                <div class="input-group mb-3">
                  <input
                    type="text"
                    class="form-control"
                    placeholder="Type something"
                    aria-label="Type Something"
                    aria-describedby="button-addon2"
                  />
                  <button
                    class="btn btn-outline-secondary"
                    type="button"
                    id="button-addon2"
                  >Comment</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {{!-- <div class="col-md-12 col-lg-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Stories</h5>
          <div class="story-list">
            <div class="story">
              <a href="#"><img
                  src="/images/avatars/profile-image.png"
                  alt=""
                /></a>
              <div class="story-info">
                <a href="#"><span class="story-author">Johan Doe</span></a>
                <span class="story-time">17min</span>
              </div>
            </div>
            <div class="story">
              <a href="#"><img
                  src="/images/avatars/profile-image.png"
                  alt=""
                /></a>
              <div class="story-info">
                <a href="#"><span class="story-author">Nina Doe</span></a>
                <span class="story-time">54min</span>
              </div>
            </div>
            <div class="story">
              <a href="#"><img
                  src="/images/avatars/profile-image.png"
                  alt=""
                /></a>
              <div class="story-info">
                <a href="#"><span class="story-author">John Doe</span></a>
                <span class="story-time">2hrs</span>
              </div>
            </div>
            <div class="story">
              <a href="#"><img
                  src="/images/avatars/profile-image.png"
                  alt=""
                /></a>
              <div class="story-info">
                <a href="#"><span class="story-author">Nina Doe</span></a>
                <span class="story-time">7hrs</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div> --}}
  </div>
</div>

<div
  class="modal fade"
  id="openUserModal"
  tabindex="-1"
  aria-labelledby="openUserModal"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-md"
  >
    <div class="modal-content">
        <form action="/users/admin/save" method="post" class="py-2" name="userEdit">

      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalScrollableTitle">Foydalanuvchi
          qo'shish</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
          <input type="hidden" name="_id">
          <input type="hidden" name="_csrf" value="{{csrf}}">
          <div class="mb-3">
            <div class="form-floating">
              <input
                type="text"
                name="name"
                class="form-control"
                id="floatingInput"
                placeholder="Ism-familiya"
              />
              <label for="floatingInput">Ism-familiya</label>
            </div>
          </div>
          <div class="mb-3">
            <div class="form-floating">
              <input
                type="text"
                name="login"
                class="form-control"
                id="floatingInput"
                placeholder="Login"
                onblur="check(event)"
              />
              <label for="floatingInput">Login</label>
              <div class="invalid-feedback" id="loginmsg">Bunday logindagi
                foydalanuvchi mavjud!</div>
            </div>
          </div>
          <div class="mb-3">
            <select class="form-select" aria-label="Default select example" name="role">
              <option selected="" disabled="disabled" >Foydalanuvchi roli</option>
              <option value="1">Superadmin</option>
              <option value="2">Foydalanuvchi</option>
              {{!-- <option value="3">Three</option> --}}
            </select>
          </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >Bekor qilish</button>
        <button type="submit" class="btn btn-primary">Saqlash</button>
      </div>
      </form>
    </div>
  </div>
</div>

<script>
    function check(e) {
        let login = e.target.value
        if (login) {
            fetch(`/users/check/${login}`)
                .then(res => res.json())
                .then(val => {
                    if (val) {
                        document.getElementById('loginmsg').style.display = 'block'
                    } else {
                        document.getElementById('loginmsg').style.display = 'none'
                    }
                })
            }
        }
    let form = document.forms.userEdit
    function editUser(id) {
      fetch(`/users/edit/${id}`)
        .then(res => res.json())
        .then(data => {
          form.login.value = data.login
          form.name.value = data.name
          form._id.value = data._id
          form.role.value = data.role
        })
    }
</script>